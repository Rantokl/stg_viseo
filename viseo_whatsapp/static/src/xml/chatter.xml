<?xml version="1.0" encoding="UTF-8"?>

    <templates xml:space="preserve">
        <t t-extend="mail.chatter.Buttons">
            <t t-jquery=".o_chatter_button_log_note" t-operation="after">
<!--                <t t-if="widget.context.user_has_group">-->
                    <button class="btn btn-link o_chatter_button_whatsapp" title="To send via Whatsapp" >
                        <i class="fa fa-whatsapp" title="Dates"/> Whatsapp
                    </button>

                <script type="text/javascript">
            $(document).ready(function() {
                $('.o_chatter_button_whatsapp').hide();

                    odoo.define('module_name.custom_script', function (require) {
                    "use strict";

                    var rpc = require('web.rpc');

                    rpc.query({
                        model: 'whatsapp.viseo',
                        method: 'computeUser',
                        args: [[]],
                        }).then(function(output){
                            console.log("Value:",output['value'])
                            if (output['value'] == 'True'){
                                $('.o_chatter_button_whatsapp').show();
                            }else{
                                $('.o_chatter_button_whatsapp').hide();
                    }

                    }).catch(function() {
                        console.error('Erreur lors de la v√©rification du groupe utilisateur.');
                    });
                });
            });
        </script>

<!--                </t>-->
            </t>
        </t>
    </templates>


<!--name="openWhatsapp"-->
<!--                >-->
<!--                -->